(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      9017,        207]
NotebookOptionsPosition[      8662,        190]
NotebookOutlinePosition[      9005,        205]
CellTagsIndexPosition[      8962,        202]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Msat", "=", 
   RowBox[{"1.36", " ", 
    SuperscriptBox["10", "6"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]0", "=", 
   RowBox[{"4", "\[Pi]", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "7"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cr1r2", " ", "=", " ", 
   FractionBox[
    RowBox[{"8", " ", 
     SuperscriptBox["Msat", "2"], " ", "\[Pi]", " ", "\[Mu]0"}], 
    RowBox[{"9", " "}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PEbefore", "[", 
    RowBox[{"r3_", ",", "r2_", ",", "s_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "cr1r2"}], "*", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["r2", "3"], 
        SuperscriptBox["r3", "3"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"r2", "+", "r3", "+", "s"}], ")"}], "3"]], "*", "2"}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PEafter", "[", 
    RowBox[{"r1_", ",", "r2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "cr1r2"}], "*", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["r1", "3"], 
        SuperscriptBox["r2", "3"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"r1", " ", "+", " ", "r2"}], ")"}], "3"]], "*", "2"}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7100817916304913`*^9, 3.710082039194401*^9}, {
   3.710082094493469*^9, 3.710082173629904*^9}, {3.710082232728557*^9, 
   3.710082234607985*^9}, {3.71008226785806*^9, 3.710082329478856*^9}, {
   3.7100824175864964`*^9, 3.710082418473033*^9}, {3.7100824526260843`*^9, 
   3.710082455233213*^9}, {3.710082500261402*^9, 3.7100825347318773`*^9}, {
   3.710082573264135*^9, 3.710082581658688*^9}, 3.71102806130459*^9, {
   3.711028198026137*^9, 3.711028238976358*^9}, {3.711028319390317*^9, 
   3.711028416596382*^9}, {3.711028771542049*^9, 3.711028947612584*^9}, {
   3.7110289983381777`*^9, 3.7110290607008243`*^9}, {3.7110292228032837`*^9, 
   3.7110293699746876`*^9}, {3.7110294205192432`*^9, 3.711029439663439*^9}, {
   3.711030008064933*^9, 3.711030167161186*^9}, {3.7110304006829157`*^9, 
   3.711030424406247*^9}, {3.711030485378827*^9, 3.7110305035234833`*^9}, {
   3.7110610890171857`*^9, 3.711061101523517*^9}, {3.7110611431117797`*^9, 
   3.711061209008283*^9}, {3.7110612533868985`*^9, 3.7110612630603743`*^9}, {
   3.7110613685257607`*^9, 3.711061441563366*^9}, {3.711061488123021*^9, 
   3.7110615092092075`*^9}, 3.7110619051982117`*^9, 3.7110620196672173`*^9, {
   3.7110621147364655`*^9, 3.7110621168102226`*^9}, {3.7110623889530425`*^9, 
   3.7110624620937414`*^9}, {3.711148696453123*^9, 3.7111487117685585`*^9}, {
   3.7111541341954775`*^9, 3.7111541361295*^9}, {3.7111543156590643`*^9, 
   3.7111543713714557`*^9}, 3.7111545219236703`*^9, {3.711154575533105*^9, 
   3.7111546564556913`*^9}, {3.711280045457587*^9, 3.711280053279708*^9}, {
   3.711280152780509*^9, 3.7112801543430934`*^9}, {3.7112802094943595`*^9, 
   3.711280251330926*^9}, {3.7112803028932967`*^9, 3.711280374346176*^9}, {
   3.711280453840906*^9, 3.7112804739394135`*^9}, {3.7112805087559547`*^9, 
   3.7112805186789465`*^9}, {3.711280558235642*^9, 3.7112805657975397`*^9}, {
   3.7112806438095*^9, 3.7112806539297886`*^9}, {3.711282375665292*^9, 
   3.7112823832962236`*^9}, {3.7112825392282944`*^9, 3.711282544334855*^9}, {
   3.711282605995675*^9, 3.711282609370844*^9}, {3.711283435702857*^9, 
   3.711283450267379*^9}, {3.7112835311005635`*^9, 3.711283549010828*^9}, {
   3.7112835974508905`*^9, 3.7112836092069674`*^9}, {3.7112837233547316`*^9, 
   3.7112837350983734`*^9}, {3.7112837696332455`*^9, 3.711283776699934*^9}, {
   3.7112838395758257`*^9, 3.7112838474463563`*^9}, {3.7112840875779333`*^9, 
   3.71128411924084*^9}, {3.711284348768368*^9, 3.7112843562386417`*^9}, {
   3.7112876609287252`*^9, 3.7112876686615143`*^9}, {3.711287771389786*^9, 
   3.711287779548009*^9}, {3.7112878114829407`*^9, 3.7112878279761176`*^9}, {
   3.7116641121355495`*^9, 3.711664123643846*^9}, {3.7116641728225594`*^9, 
   3.7116641922023697`*^9}, {3.7116642675028353`*^9, 3.711664283608061*^9}, {
   3.7116643487416673`*^9, 3.7116643691988716`*^9}, {3.711664404607935*^9, 
   3.7116644785736628`*^9}, {3.711664701962214*^9, 3.711664711210531*^9}, {
   3.71166508566488*^9, 3.7116651143678064`*^9}, {3.711665159433857*^9, 
   3.711665269808741*^9}, {3.7116653971388702`*^9, 3.71166541260522*^9}, 
   3.7116654442929153`*^9, {3.7116654743926773`*^9, 3.7116655696095686`*^9}, {
   3.711665643147328*^9, 3.7116657280092087`*^9}, {3.7116658071728706`*^9, 
   3.7116658419161572`*^9}, {3.7116659267460785`*^9, 
   3.7116659494864073`*^9}, {3.7116660263217726`*^9, 
   3.7116662938789415`*^9}, {3.7116664055645123`*^9, 3.711666422078272*^9}, {
   3.7116664963288374`*^9, 3.711666537003118*^9}, {3.711666573780012*^9, 
   3.7116665820779223`*^9}, {3.711666612878049*^9, 3.7116666164708757`*^9}, {
   3.711668163580773*^9, 3.7116681739657764`*^9}, {3.7116682160760994`*^9, 
   3.711668226126686*^9}, 3.711755437052969*^9, {3.7117554914009953`*^9, 
   3.71175551098775*^9}, 3.7117555802739315`*^9, {3.711755612395727*^9, 
   3.711755620837331*^9}, {3.711755739816148*^9, 3.7117557649644814`*^9}, {
   3.7117560776376095`*^9, 3.7117562070909295`*^9}, {3.71175637098407*^9, 
   3.7117564132988167`*^9}, {3.711756484483636*^9, 3.7117565894769125`*^9}, {
   3.7138941944056263`*^9, 3.713894348210885*^9}, {3.714349590462163*^9, 
   3.714349624934678*^9}, {3.714349741927781*^9, 3.714349760521192*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"r1", ",", "r2", ",", "a", ",", "s", ",", "r3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NMinimize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"PEafter", "[", 
       RowBox[{"r1", ",", "r2"}], "]"}], "-", 
      RowBox[{"PEbefore", "[", 
       RowBox[{"r3", ",", "r2", ",", "s"}], "]"}]}], ",", 
     RowBox[{"s", ">", "0"}], ",", 
     RowBox[{
      RowBox[{"1", "/", "6"}], "\[GreaterEqual]", " ", "r1", ">", "0.15"}], 
     ",", 
     RowBox[{
      RowBox[{"1", "/", "6"}], "\[GreaterEqual]", " ", "r2", ">", "0.15"}], 
     ",", 
     RowBox[{
      RowBox[{"1", "/", "6"}], "\[GreaterEqual]", " ", "r3", ">", "0.01"}], 
     ",", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "r1"}], "+", 
       RowBox[{"2", "r2"}], "+", 
       RowBox[{"2", "r3"}], "+", "s"}], "\[Equal]", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"r1", ",", "r2", ",", "r3", ",", "s"}], "}"}], ",", 
   RowBox[{"Method", "\[Rule]", "\"\<SimulatedAnnealing\>\""}]}], 
  "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQLaZ4zPzUsteOXGcOuYBo59mzssD8mzmFIPp7ZmkH
iG4xMukE0Z9WcntnLH/tyGD3yAdM9+/LBdGNUxgrQbRU9slaEP1mjkcTiI5e
mF2bCaR3JExoANEMT1cuBdFLzrAvB9FzOC4/BNE+P/0eg2jVGrMXIDpNbsZr
EP1EysAuB0j35U+2B9FVigFJhUD62L57WSDaymBDRRGQZkm8UA2it3l+lNi4
+rWjxyU+HRD9aLuICYi2uSoHpp89v2AFohlOnbAF0ZtSXziB6B2OF53B+rob
Q8H6lkSHg+iZP96596957Xgjhi8YRNddWRoJov+UP04A0YeiJ2eC6GnHZoLp
I0eF80C01WnHYhAd0BRSDqIPv7wNpk8Hm9SB6KjqgFYQLfTv9gYwbTFhE4je
8KVuG4i267l2AEQDAIVz5VI=
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "7511.760702781921`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r1", "\[Rule]", "0.16666666605094113`"}], ",", 
     RowBox[{"r2", "\[Rule]", "0.16666666605088581`"}], ",", 
     RowBox[{"r3", "\[Rule]", "0.010000744419565622`"}], ",", 
     RowBox[{"s", "\[Rule]", "0.3133318469572149`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7138947096604166`*^9, 3.7138947544543295`*^9}, 
   3.713894818859926*^9, {3.7138948733052816`*^9, 3.7138948955836535`*^9}, 
   3.7138949445460215`*^9, 3.713895100037671*^9, {3.7143497028777943`*^9, 
   3.7143497073949385`*^9}, {3.7143498520121765`*^9, 3.7143498692180734`*^9}, 
   3.7143499121810093`*^9, 3.714349948413199*^9, 3.7143499877838655`*^9, 
   3.714350021419359*^9, 3.7143500874568477`*^9, 3.7143501275548897`*^9, 
   3.7143505009643087`*^9, {3.7143505358769283`*^9, 3.7143506037188015`*^9}}]
}, Open  ]]
},
WindowSize->{1280, 941},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5585, 103, 205, "Input"],
Cell[CellGroupData[{
Cell[6168, 127, 1561, 41, 69, "Input"],
Cell[7732, 170, 914, 17, 30, "Output"]
}, Open  ]]
}
]
*)

